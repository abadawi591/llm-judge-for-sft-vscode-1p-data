<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 380">
  <defs>
    <linearGradient id="inputGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#3b82f6;stop-opacity:0.3"/>
      <stop offset="100%" style="stop-color:#1e40af;stop-opacity:0.3"/>
    </linearGradient>
    <linearGradient id="outputGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981;stop-opacity:0.3"/>
      <stop offset="100%" style="stop-color:#047857;stop-opacity:0.3"/>
    </linearGradient>
    <filter id="glow">
      <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="800" height="380" fill="#0d1117"/>
  
  <!-- Title -->
  <text x="400" y="35" fill="#e6edf3" font-family="system-ui, -apple-system, sans-serif" font-size="18" font-weight="600" text-anchor="middle">TOKEN DATA FLOW</text>
  
  <!-- Copilot Client Box -->
  <rect x="40" y="60" width="320" height="260" rx="12" fill="url(#inputGrad)" stroke="#3b82f6" stroke-width="2"/>
  <text x="200" y="90" fill="#3b82f6" font-family="system-ui, sans-serif" font-size="14" font-weight="600" text-anchor="middle">COPILOT CLIENT (INPUT)</text>
  
  <!-- Estimates Box -->
  <rect x="60" y="110" width="280" height="190" rx="8" fill="#161b22" stroke="#30363d" stroke-width="1"/>
  <text x="200" y="138" fill="#e6edf3" font-family="system-ui, sans-serif" font-size="13" font-weight="500" text-anchor="middle">ESTIMATES</text>
  <line x1="80" y1="150" x2="320" y2="150" stroke="#30363d" stroke-width="1"/>
  
  <!-- Estimate fields -->
  <text x="80" y="175" fill="#7ee787" font-family="monospace" font-size="12">systemTokens</text>
  <text x="80" y="198" fill="#7ee787" font-family="monospace" font-size="12">userTokens</text>
  <text x="80" y="221" fill="#7ee787" font-family="monospace" font-size="12">assistantTokens</text>
  <text x="80" y="244" fill="#7ee787" font-family="monospace" font-size="12">toolResultTokens</text>
  <line x1="80" y1="255" x2="320" y2="255" stroke="#30363d" stroke-width="1" stroke-dasharray="4,4"/>
  <text x="80" y="280" fill="#ffa657" font-family="monospace" font-size="12" font-weight="600">trajectoryTotal</text>
  
  <!-- Arrow -->
  <path d="M 380 190 L 440 190" stroke="#8b949e" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#8b949e"/>
    </marker>
  </defs>
  <text x="410" y="175" fill="#8b949e" font-family="system-ui, sans-serif" font-size="11" text-anchor="middle">API</text>
  <text x="410" y="190" fill="#8b949e" font-family="system-ui, sans-serif" font-size="11" text-anchor="middle">Call</text>
  
  <!-- LLM API Box -->
  <rect x="460" y="60" width="300" height="260" rx="12" fill="url(#outputGrad)" stroke="#10b981" stroke-width="2"/>
  <text x="610" y="90" fill="#10b981" font-family="system-ui, sans-serif" font-size="14" font-weight="600" text-anchor="middle">LLM API (OUTPUT)</text>
  
  <!-- Actuals Box -->
  <rect x="480" y="110" width="260" height="140" rx="8" fill="#161b22" stroke="#30363d" stroke-width="1"/>
  <text x="610" y="138" fill="#e6edf3" font-family="system-ui, sans-serif" font-size="13" font-weight="500" text-anchor="middle">ACTUALS</text>
  <line x1="500" y1="150" x2="720" y2="150" stroke="#30363d" stroke-width="1"/>
  
  <!-- Actual fields -->
  <text x="500" y="180" fill="#7ee787" font-family="monospace" font-size="12">promptTokens</text>
  <text x="500" y="205" fill="#7ee787" font-family="monospace" font-size="12">completionTokens</text>
  <text x="500" y="230" fill="#7ee787" font-family="monospace" font-size="12">maxTokenWindow</text>
  
  <!-- Labels at bottom -->
  <text x="200" y="340" fill="#8b949e" font-family="system-ui, sans-serif" font-size="11" text-anchor="middle">Fast client tokenizer</text>
  <text x="200" y="355" fill="#6e7681" font-family="system-ui, sans-serif" font-size="10" text-anchor="middle">(for truncation decisions)</text>
  
  <text x="610" y="340" fill="#8b949e" font-family="system-ui, sans-serif" font-size="11" text-anchor="middle">Model's actual tokenizer</text>
  <text x="610" y="355" fill="#6e7681" font-family="system-ui, sans-serif" font-size="10" text-anchor="middle">(for billing/limits)</text>
</svg>
